import tkinter as tk
from tkinter import messagebox
import pandas as pd
import os

# Excel file path
excel_file = "module_data.xlsx"
lid_value = "04-apl-00"

def save_to_excel():
    module = module_entry.get().strip()
    interfaces = interface_entry.get().strip()
    sid = sid_entry.get().strip()

    if not module or not interfaces or not sid:
        messagebox.showerror("Input Error", "Please fill in all fields.")
        return

    # Split interfaces by comma and strip spaces
    interface_list = [i.strip() for i in interfaces.split(",") if i.strip()]

    # Create data rows
    data = {
        "Module Name": [module] * len(interface_list),
        "Interface Name": interface_list,
        "SID Name": [sid] * len(interface_list),
        "LID": [lid_value] * len(interface_list)
    }

    df_new = pd.DataFrame(data)

    # Append or create Excel
    if os.path.exists(excel_file):
        df_existing = pd.read_excel(excel_file)
        df_combined = pd.concat([df_existing, df_new], ignore_index=True)
        df_combined.to_excel(excel_file, index=False)
    else:
        df_new.to_excel(excel_file, index=False)

    messagebox.showinfo("Success", f"Data saved for module '{module}'")
    module_entry.delete(0, tk.END)
    interface_entry.delete(0, tk.END)
    sid_entry.delete(0, tk.END)

# Create GUI window
root = tk.Tk()
root.title("Module Interface Entry")

tk.Label(root, text="Module Name:").grid(row=0, column=0, padx=10, pady=5, sticky="e")
module_entry = tk.Entry(root, width=40)
module_entry.grid(row=0, column=1, pady=5)

tk.Label(root, text="Interfaces (comma-separated):").grid(row=1, column=0, padx=10, pady=5, sticky="e")
interface_entry = tk.Entry(root, width=40)
interface_entry.grid(row=1, column=1, pady=5)

tk.Label(root, text="SID Name:").grid(row=2, column=0, padx=10, pady=5, sticky="e")
sid_entry = tk.Entry(root, width=40)
sid_entry.grid(row=2, column=1, pady=5)

save_button = tk.Button(root, text="Save to Excel", command=save_to_excel)
save_button.grid(row=3, column=0, columnspan=2, pady=10)

root.mainloop()
